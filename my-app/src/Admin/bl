import React from 'react'
import { useState, useEffect } from 'react';
import { Swiper, SwiperSlide } from 'swiper/react';
import { Autoplay, Pagination, Navigation } from 'swiper/modules';
import { Link } from 'react-router-dom';

import UserDoctorList from './userDoctorList';
import { getRows } from '../utils/db';

import { User, Users, Mail, SquareCheckBig, Building2, NotebookTabs, Ambulance, Microscope, Hand, Hotel, Smile, Medal, PhoneCall, Heart, Syringe, BriefcaseMedical, Activity, Stethoscope, House, Quote, Facebook, Twitter, Instagram, Linkedin} from 'lucide-react';

// Assets (Assuming these paths remain the same)
import img1 from '../assets/img1.png'
import img2 from '../assets/img2.png'
import img3 from '../assets/img3.png'
import AboutImg from '../assets/about.png'
import image from '../assets/image1.jpg'
import image2 from '../assets/image2.jpg'
import image3 from '../assets/image3.jpg'
import image4 from '../assets/image4.jpg'
import image5 from '../assets/image5.jpg'
import gallery1 from '../assets/pf1.jpg'
import gallery2 from '../assets/pf2.jpg'
import gallery3 from '../assets/pf3.jpg'
import gallery4 from '../assets/pf4.jpg'
import gallery5 from '../assets/pf5.jpg'
import gallery6 from '../assets/pf6.jpg'
import com1 from '../assets/testi1.jpg'

import 'swiper/css';
import 'swiper/css/pagination';
import 'swiper/css/navigation';

const Home = () => {
  const slides = [
    { title: "Superior solution that help you live healthier", img: img1 },
    { title: "Find a doctor and book appointment", img: img2 },
    { title: "We only give the best care", img: img3 }
  ];

  const deptData = [
    {
      id: 'cardiology',
      name: 'Cardiology',
      icon: <Heart size={20} className="text-green-500" />,
      title: 'Cardiology',
      image: image,
      points: ["Heart Checkup, ECG, Stress Test", "Echocardiography", "Cardiac Catheterization"]
    },
    {
      id: 'stomatology',
      name: 'Stomatology',
      icon: <Syringe size={20} className="text-green-500" />,
      title: 'Stomatology',
      image: image2,
      points: ["Modern Dental Care", "Orthodontics", "Cosmetic Dentistry"]
    },
    {
        id: 'radiology',
        name: 'Radiology',
        icon: <BriefcaseMedical size={20} className="text-green-500" />,
        title: 'Radiology',
        image: image3,
        points: ["High Resolution imaging", "X-rays, MRI, CT Scans", "Ultrasound"]
      },
      {
        id: 'Neurology',
        name: 'Neurology',
        icon: <Activity size={20} className="text-green-500" />,
        title: 'Neurology',
        image: image4,
        points: ["Brain and Nervous System Care", "Stroke Management", "Neurodegenerative Treatment"]
      },
      {
        id: 'Opthalmology',
        name: 'Opthalmology',
        icon: <Stethoscope size={20} className="text-green-500" />,
        title: 'Opthalmology',
        image: image5,
        points: ["Eye Exams", "Cataract Surgery", "Glaucoma Treatment"]
      }
  ];

  const getGallery = [
    { id: 1, category: 'Cardiology', image: gallery4 },
    { id: 2, category: 'Diabetes', image: gallery1 },
    { id: 3, category: 'Diabetes', image: gallery2 },
    { id: 4, category: 'Pediatrics', image: gallery3 },
    { id: 5, category: 'Pediatrics', image: gallery5 },
    { id: 6, category: 'Neurosurgery', image: gallery6 }
  ];

  const [filter, setFilter] = useState('All');
  const [activeDept, setActiveDept] = useState(deptData[0]);
  const [blog, setBlog] = useState([]);

  const filterImages = filter === 'All' ? getGallery : getGallery.filter(img => img.category === filter);

  useEffect(() => {
    const fetchBlogs = async () => {
      try {
        const data = await getRows(import.meta.env.VITE_APPWRITE_BLOGS_TABLE_ID);
        const rows = Array.isArray(data) ? data : data?.rows || data?.documents || [];
        setBlog(rows);
      } catch (error) {
        console.error("Error fetching blogs:", error);
      }
    };
    fetchBlogs();
  }, []);

  return (
    <div className='pt-20 md:pt-28 overflow-x-hidden'>
      {/* Hero Section */}
      <section className='bg-[#F9F9F9] w-full'>
        <Swiper
          modules={[Navigation, Autoplay, Pagination]}
          navigation={true}
          autoplay={{ delay: 5000 }}
          pagination={{ clickable: true }}
          loop={true}
          className='mySwiper h-[550px] md:h-[600px]'
        >
          {slides.map((slide, index) => (
            <SwiperSlide key={index}>
              <div className='max-w-7xl mx-auto h-full grid grid-cols-1 md:grid-cols-2 items-center px-6 gap-5'>
                <div className='space-y-6 z-10 text-center md:text-left'>
                  <h1 className='font-serif text-3xl md:text-5xl font-bold text-black leading-tight'>{slide.title}</h1>
                  <p className='font-sans text-gray-500 max-w-md mx-auto md:mx-0'>
                    Since the first days of our practice, we have been dedicated to providing good healthcare.
                  </p>
                  <div className='flex flex-col sm:flex-row gap-4 justify-center md:justify-start'>
                    <Link to="/appointment">
                      <button className='w-full sm:w-auto bg-[#064e3b] text-white px-8 py-3 rounded-sm font-semibold hover:bg-black transition-all'>Book Appointment</button>
                    </Link>
                    <Link to="/about-us">
                      <button className='w-full sm:w-auto bg-[#a3e635] text-[#064e3b] px-8 py-3 rounded-sm font-semibold hover:bg-[#84cc16] transition-all'>About us</button>
                    </Link>
                  </div>
                </div>
                <div className='hidden md:flex justify-end h-full items-end'>
                  <img src={slide.img} alt="" className='h-[90%] lg:h-[110%] object-contain' />
                </div>
              </div>
            </SwiperSlide>
          ))}
        </Swiper>
      </section>

      {/* Quick Appointment Form */}
      <section className='py-12 md:py-20 px-6'>
        <div className='max-w-7xl mx-auto'>
          <div className='space-y-4 mb-10'>
            <h1 className='font-serif text-3xl md:text-4xl font-bold text-[#060707]'>Book An Appointment</h1>
            <p className='font-sans text-gray-500 max-w-2xl text-sm'>
              Please feel welcome to contact us to book an appointment with one of our healthcare professionals.
            </p>
          </div>
          <form className='flex flex-col lg:flex-row gap-4'>
            <div className='relative flex-1'>
              <input type="text" placeholder='Full Name' className='p-4 w-full h-12 border border-gray-200 focus:ring-2 focus:ring-green-600 outline-none text-sm'/>
              <User className='absolute top-1/2 right-3 -translate-y-1/2 text-gray-400' size={16} />
            </div>
            <div className='relative flex-1'>
              <input type="email" placeholder='Email Address' className='p-4 w-full h-12 border border-gray-200 focus:ring-2 focus:ring-green-600 outline-none text-sm'/>
              <Mail className='absolute top-1/2 right-3 -translate-y-1/2 text-gray-400' size={16} />
            </div>
            <div className='relative flex-1'>
              <input type="tel" placeholder='Phone Number' className='p-4 w-full h-12 border border-gray-200 focus:ring-2 focus:ring-green-600 outline-none text-sm'/>
              <PhoneCall className='absolute top-1/2 right-3 -translate-y-1/2 text-gray-400' size={16} />
            </div>
            <button className='flex-1 bg-green-600 text-white h-12 font-semibold hover:bg-green-700 transition-colors'>Get Appointment</button>
          </form>
        </div>
      </section>

      {/* About Section */}
      <section className='bg-[#F9F9F9] py-16 md:py-24 px-6'>
        <div className='max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-12 items-center'>
          <img src={AboutImg} alt="About Us" className='w-full rounded-lg shadow-sm' />
          <div className='space-y-6'>
            <span className='inline-block bg-green-400 text-white px-4 py-1 rounded-sm text-sm font-sans'>About</span>
            <h2 className='font-serif text-3xl md:text-4xl font-bold'>Thousands of specialists for all your healthcare needs</h2>
            <p className='text-gray-500 text-sm leading-relaxed'>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
            <ul className='grid grid-cols-1 sm:grid-cols-2 gap-3'>
              {["Eye health checkup", "Lasic treatment", "Minor illnesses", "Special Eye exams", "Contact lens services", "Retinal exams"].map((item, i) => (
                <li key={i} className='flex gap-2 items-center text-sm'><SquareCheckBig className='text-green-400' size={18}/> {item}</li>
              ))}
            </ul>
            <Link to="/about-us" className='inline-block bg-green-500 text-white px-8 py-3 font-sans text-sm hover:bg-green-600 transition-all'>More About Us</Link>
          </div>
        </div>
      </section>

      {/* Specialties Tabs */}
      <section className='py-16 md:py-24 px-6'>
        <div className='max-w-7xl mx-auto text-center mb-12'>
          <h1 className='font-serif text-3xl md:text-4xl font-bold mb-4'>Specialties Available at MedLab</h1>
          <p className='text-gray-500 max-w-2xl mx-auto'>Variations of passages of Lorem Ipsum available, but the majority have suffered alteration.</p>
        </div>
        <div className='max-w-7xl mx-auto'>
          <div className='flex flex-wrap bg-[#f8f9fa] border border-gray-100'>
            {deptData.map((dept) => (
              <button
                key={dept.id}
                onClick={() => setActiveDept(dept)}
                className={`flex-1 min-w-[150px] flex items-center justify-center gap-2 p-4 text-sm transition-all border-r border-b border-gray-100 ${activeDept.id === dept.id ? 'bg-white text-green-600 font-bold' : 'text-gray-600 hover:bg-white'}`}
              >
                {dept.icon} <span>{dept.name}</span>
              </button>
            ))}
          </div>
          <div className='grid grid-cols-1 md:grid-cols-2 gap-10 mt-12 items-center'>
            <img src={activeDept.image} alt={activeDept.title} className='w-full h-80 md:h-[500px] object-cover rounded-md animate-fade-In' />
            <div className='space-y-6'>
              <h2 className='font-serif text-3xl font-bold'>{activeDept.title}</h2>
              <div className='space-y-3'>
                {activeDept.points.map((p, i) => (
                  <div key={i} className='flex gap-3 text-sm'><SquareCheckBig className='text-green-500' size={18}/>{p}</div>
                ))}
              </div>
              <p className='text-gray-400 text-sm'>Our team of healthcare professionals is here to assist you with any questions or concerns you may have.</p>
              <button className='bg-green-600 text-white px-8 py-3 hover:bg-green-700 transition-all'>View Specialties</button>
            </div>
          </div>
        </div>
      </section>

      {/* Stats Section */}
      <section className='bg-green-800 py-16 px-6'>
        <div className='max-w-7xl mx-auto grid grid-cols-2 md:grid-cols-4 gap-8'>
          {[
            { icon: <Hotel />, label: "Hospital Rooms", val: "400" },
            { icon: <Stethoscope />, label: "Special Doctors", val: "150" },
            { icon: <Smile />, label: "Happy Patients", val: "600" },
            { icon: <Medal />, label: "Years Experience", val: "20" }
          ].map((stat, i) => (
            <div key={i} className='flex flex-col items-center text-center text-white space-y-2'>
              <div className='bg-white p-4 rounded-full text-green-600 mb-2'>{React.cloneElement(stat.icon, { size: 30 })}</div>
              <h4 className='text-3xl font-bold'>{stat.val}</h4>
              <p className='text-xs uppercase tracking-wider font-semibold opacity-80'>{stat.label}</p>
            </div>
          ))}
        </div>
      </section>

      {/* Services Grid */}
      <section className='py-20 px-6'>
        <div className='max-w-7xl mx-auto'>
            <div className='text-center mb-16'>
                <h2 className='text-3xl md:text-4xl font-serif font-bold mb-4'>Services Provided by MedLab</h2>
                <p className='text-gray-500 max-w-2xl mx-auto'>High-quality care through modern technology and specialized professionals.</p>
            </div>
            <div className='grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-0 border border-gray-100'>
                {[
                    { icon: <Ambulance />, title: "Fast Ambulance" },
                    { icon: <Stethoscope />, title: "Dental Specialist" },
                    { icon: <Microscope />, title: "Modern Laboratory" },
                    { icon: <Users />, title: "Children Center" },
                    { icon: <Heart />, title: "Heart Surgery" },
                    { icon: <Hand />, title: "Care Advice" }
                ].map((service, i) => (
                    <div key={i} className='group p-10 border border-gray-100 hover:bg-green-600 transition-all duration-300'>
                        <div className='w-16 h-16 bg-green-600 flex items-center justify-center text-white mb-6 group-hover:bg-white group-hover:text-green-600 transition-colors'>
                            {React.cloneElement(service.icon, { size: 32 })}
                        </div>
                        <h3 className='text-xl font-serif font-bold mb-3 group-hover:text-white'>{service.title}</h3>
                        <p className='text-gray-500 text-sm group-hover:text-green-50'>Variations of passages of Lorem Ipsum available, but the majority have suffered alteration.</p>
                    </div>
                ))}
            </div>
        </div>
      </section>

      {/* Gallery Filter */}
      <section className='bg-[#F9F9F9] py-20 px-6'>
        <div className='max-w-7xl mx-auto'>
          <div className='text-center mb-12'>
            <h2 className='text-3xl font-serif font-bold mb-4'>Latest Cases</h2>
            <div className='flex flex-wrap justify-center gap-2 mt-6'>
              {['All', 'Cardiology', 'Diabetes', 'Pediatrics', 'Neurosurgery'].map((cat) => (
                <button key={cat} onClick={() => setFilter(cat)} className={`px-4 py-2 text-xs border rounded-sm transition-all ${filter === cat ? 'bg-green-600 text-white border-green-600' : 'bg-white text-gray-600 hover:bg-green-50'}`}>{cat}</button>
              ))}
            </div>
          </div>
          <div className='grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6'>
            {filterImages.map(item => (
              <div key={item.id} className='relative group overflow-hidden rounded-sm aspect-[4/3]'>
                <img src={item.image} alt={item.category} className='w-full h-full object-cover transition-transform duration-500 group-hover:scale-110' />
                <div className='absolute inset-0 bg-green-900/80 opacity-0 group-hover:opacity-100 transition-all duration-300 flex flex-col justify-center items-center text-white p-6'>
                  <p className='text-xs uppercase mb-2'>Medical Care</p>
                  <h3 className='text-lg font-bold font-serif mb-4'>{item.category} Case Study</h3>
                  <div className='p-2 border border-white/40'><BriefcaseMedical size={20} /></div>
                </div>
              </div>
            ))}
          </div>
        </div>
      </section>

      {/* Blogs Section */}
      <section className='py-20 px-6'>
        <div className='max-w-7xl mx-auto'>
          <h2 className='text-3xl font-serif font-bold text-center mb-12'>Latest News</h2>
          <div className='grid grid-cols-1 lg:grid-cols-2 gap-8'>
            {blog.slice(0, 4).map((item) => (
              <Link to={`/blog/${item.$id}`} key={item.$id} className='flex flex-col sm:flex-row border border-gray-100 hover:shadow-md transition-shadow group'>
                <div className='w-full sm:w-48 h-48 overflow-hidden'>
                    <img src={item.imageUrl} alt="" className='w-full h-full object-cover group-hover:scale-105 transition-transform' />
                </div>
                <div className='p-6 flex-1 flex flex-col justify-between'>
                  <div>
                    <h3 className='text-xl font-bold font-serif mb-2 capitalize'>{item.title}</h3>
                    <p className='text-gray-500 text-sm line-clamp-2'>The price is something not defined as financial. it could be time...</p>
                  </div>
                  <div className='flex justify-between items-center text-xs text-gray-400 mt-4'>
                    <span className='font-semibold text-green-600'>{item.author}</span>
                    <span>{item.date}</span>
                  </div>
                </div>
              </Link>
            ))}
          </div>
        </div>
      </section>
    </div>
  )
}

export default Home;